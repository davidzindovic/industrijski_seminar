 Program
   BeforeStart
     MoveJ
       Waypoint_13
     Gripper Activate
     If  not digital_in[4]
       Popup: Postavi skatlo k zadnjemu senzorju :)
       Loop  not digital_in[4]
         'prazen loop ne laufa :)'
     open_socket≔socket_open("192.168.65.102",50000,"student")
     Loop  not open_socket
       open_socket≔socket_open("192.168.65.102",50000,"student")
   Robot Program
     MoveL
       Waypoint_4
       Gripper Open (2)
     If  not digital_in[5]
       Set DO[5]=On
     Loop  not digital_in[5]
       'cakam da se skatla pripelje'
     Set DO[5]=Off
     'tcp ip skatla prispela'
     If open_socket
       was_send≔socket_send_string("PRISPELA","student")
       Loop  not was_send
         was_send≔socket_send_string("PRISPELA","student")
         Wait: 0.01
       Wait: 0.01
     MoveL
       Waypoint_14
       'premik za prijem pokrova'
     Gripper Close (2)
     'gripper primer pokrov'
     Set DO[0]=On
     'vkopi napajanje za kljucavnico'
     'tcp ip skatla odklenjena'
     If open_socket
       was_send≔socket_send_string("ODKLENJENA","student")
       Loop  not was_send
         was_send≔socket_send_string("ODKLENJENA","student")
         Wait: 0.01
       Wait: 0.01
     MoveL
       Waypoint_5
       'dvigne pokrov'
     'tcp_ip skatla je odprta'
     If open_socket
       was_send≔socket_send_string("ODPRTA","student")
       Loop  not was_send
         was_send≔socket_send_string("ODPRTA","student")
         Wait: 0.01
       Wait: 0.01
     Set DO[0]=Off
     'izklopi napajanje kljucavice (<4s)'
     MoveL
       Waypoint_6
       'pokrov premakne k zadnjemu delu skatle'
     Gripper Open (2)
     'odpre prijemalo'
     MoveL
       Waypoint_11
       'stran od skatle'
       Waypoint_13
       'domov = opravi task'
       Wait: 2.0
       Waypoint_11
       'se postavi nad skatlo'
       Gripper Open (2)
       'odpre gripper'
       Waypoint_6
       'se locira pri bunki za prijet'
       Gripper Close (2)
       'zapre prijemalo'
       Waypoint_5
       'dvigne pokrov'
       Waypoint_14
       'pokrov postavi v zacetno pozicijo'
       If open_socket
         was_send≔socket_send_string("ZAPRTA","student")
         Loop  not was_send
           was_send≔socket_send_string("ZAPRTA","student")
           Wait: 0.01
         Wait: 0.01
       Gripper Open (2)
       'odpre gripper'
       Set DO[0]=On
       'vklopi napajanje za kljucavnico'
       Wait: 1.0
       Set DO[0]=Off
       'izklopi napajanje za kljucavnico'
       If open_socket
         was_send≔socket_send_string("ZAKLENJENA","student")
         Loop  not was_send
           was_send≔socket_send_string("ZAKLENJENA","student")
           Wait: 0.01
         Wait: 0.01
       Waypoint_13
       'domov'
     If digital_in[5]
       Set DO[5]=On
       'ce je skatla se pri senzorju posljemo naprej'
       'tcp_ip skatla sla naprej'
       If open_socket
         was_send≔socket_send_string("ODPRAVLJENA","student")
         Loop  not was_send
           was_send≔socket_send_string("ODPRAVLJENA","student")
           Wait: 0.01
         Wait: 0.01
     Loop digital_in[5]
       'cakam da skatla ne bo vec pri senzorju'
     Set DO[5]=Off
     socket_close("student")
     Halt
